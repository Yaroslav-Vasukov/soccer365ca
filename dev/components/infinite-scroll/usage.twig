{# 1. Lives page (lives.html) #}
{% extends "../layouts/_base.html" %}
{% block title %}Lives{% endblock %}
{% block active_nav %}lives{% endblock %}
{% block body_class %}page page--lives{% endblock %}

{% block content %}
{% set lives = load_json("@/data/lives.json") %}

{% include "../components/page-head/page-head.twig" with {
  title: "Live Matches",
  subtitle: "Popular live matches",
  breadcrumbs: [
    { label: "Home", href: "/", home: true },
    { label: "Live Matches" }
  ],
  meta: {
    count: lives|length ~ " Lives" 
  }
} only %}

<section class="section section--margin">
  <div class="container">
    <div class="section__inner">
      {% include "../components/infinite-scroll/infinite-scroll.twig" with {
        type: 'live',
        data: lives,
        initial_count: 8,
        items_per_page: 8,
        loading_text: 'Loading more matches...',
        end_text: 'All matches loaded',
        no_items_text: 'No live matches available'
      } only %}
    </div>
  </div>
</section>
{% endblock %}

{# 2. News page (news.html) #}
{% extends "../layouts/_base.html" %}
{% block title %}News{% endblock %}
{% block active_nav %}news{% endblock %}
{% block body_class %}page page--news{% endblock %}

{% block content %}
{% set posts = load_json("@/data/posts.json") %}

{% include "../components/page-head/page-head.twig" with {
  title: "Latest News",
  subtitle: "Stay updated with football news",
  breadcrumbs: [
    { label: "Home", href: "/", home: true },
    { label: "News" }
  ],
  meta: {
    count: posts|length ~ " Articles" 
  }
} only %}

<section class="section section--margin">
  <div class="container">
    <div class="section__inner">
      {% include "../components/infinite-scroll/infinite-scroll.twig" with {
        type: 'news',
        data: posts,
        initial_count: 12,
        items_per_page: 8,
        loading_text: 'Loading more articles...',
        end_text: 'All articles loaded',
        no_items_text: 'No news articles found'
      } only %}
    </div>
  </div>
</section>
{% endblock %}

{# 3. Videos page (videos.html) #}
{% extends "../layouts/_base.html" %}
{% block title %}Videos{% endblock %}
{% block active_nav %}videos{% endblock %}
{% block body_class %}page page--videos{% endblock %}

{% block content %}
{% set videos = load_json("@/data/videos.json") %}

{% include "../components/page-head/page-head.twig" with {
  title: "Latest Videos",
  subtitle: "Watch highlights and interviews",
  breadcrumbs: [
    { label: "Home", href: "/", home: true },
    { label: "Videos" }
  ],
  meta: {
    count: videos|length ~ " Videos" 
  }
} only %}

<section class="section section--margin">
  <div class="container">
    <div class="section__inner">
      {% include "../components/infinite-scroll/infinite-scroll.twig" with {
        type: 'video',
        data: videos,
        initial_count: 9,
        items_per_page: 9,
        loading_text: 'Loading more videos...',
        end_text: 'All videos loaded',
        no_items_text: 'No videos found'
      } only %}
    </div>
  </div>
</section>
{% endblock %}

{# 4. Teams page (teams.html) #}
{% extends "../layouts/_base.html" %}
{% block title %}Teams{% endblock %}
{% block active_nav %}teams{% endblock %}
{% block body_class %}page page--teams{% endblock %}

{% block content %}
{% set teams = load_json("@/data/teams.json") %}

{% include "../components/page-head/page-head.twig" with {
  title: "Football Teams",
  subtitle: "Explore all teams",
  breadcrumbs: [
    { label: "Home", href: "/", home: true },
    { label: "Teams" }
  ],
  meta: {
    count: teams|length ~ " Teams" 
  }
} only %}

<section class="section section--margin">
  <div class="container">
    <div class="section__inner">
      {% include "../components/infinite-scroll/infinite-scroll.twig" with {
        type: 'team',
        data: teams,
        initial_count: 12,
        items_per_page: 12,
        loading_text: 'Loading more teams...',
        end_text: 'All teams loaded',
        no_items_text: 'No teams found'
      } only %}
    </div>
  </div>
</section>
{% endblock %}

{# 5. Players page (players.html) - новая страница #}
{% extends "../layouts/_base.html" %}
{% block title %}Players{% endblock %}
{% block active_nav %}players{% endblock %}
{% block body_class %}page page--players{% endblock %}

{% block content %}
{% set players = load_json("@/data/players.json") %}

{% include "../components/page-head/page-head.twig" with {
  title: "Football Players",
  subtitle: "Top players from around the world",
  breadcrumbs: [
    { label: "Home", href: "/", home: true },
    { label: "Players" }
  ],
  meta: {
    count: players|length ~ " Players" 
  }
} only %}

<section class="section section--margin">
  <div class="container">
    <div class="section__inner">
      {% include "../components/infinite-scroll/infinite-scroll.twig" with {
        type: 'player',
        data: players,
        initial_count: 16,
        items_per_page: 16,
        loading_text: 'Loading more players...',
        end_text: 'All players loaded',
        no_items_text: 'No players found'
      } only %}
    </div>
  </div>
</section>
{% endblock %}

{# 6. Leagues page (leagues.html) - новая страница #}
{% extends "../layouts/_base.html" %}
{% block title %}Leagues{% endblock %}
{% block active_nav %}leagues{% endblock %}
{% block body_class %}page page--leagues{% endblock %}

{% block content %}
{% set leagues = load_json("@/data/leagues.json") %}

{% include "../components/page-head/page-head.twig" with {
  title: "Football Leagues",
  subtitle: "Major leagues worldwide",
  breadcrumbs: [
    { label: "Home", href: "/", home: true },
    { label: "Leagues" }
  ],
  meta: {
    count: leagues|length ~ " Leagues" 
  }
} only %}

<section class="section section--margin">
  <div class="container">
    <div class="section__inner">
      {% include "../components/infinite-scroll/infinite-scroll.twig" with {
        type: 'league',
        data: leagues,
        initial_count: 8,
        items_per_page: 8,
        loading_text: 'Loading more leagues...',
        end_text: 'All leagues loaded',
        no_items_text: 'No leagues found'
      } only %}
    </div>
  </div>
</section>
{% endblock %}

{# Обновленный main.js для инициализации #}
<script type="module">
// main.js - добавить эту функцию
when("[data-infinite-scroll]", () =>
  import("@components/infinite-scroll/infinite-scroll.js"),
  (module) => {
    const containers = document.querySelectorAll('[data-infinite-scroll]');
    
    containers.forEach(container => {
      const cardType = container.dataset.cardType || 'default';
      const itemsPerPage = parseInt(container.dataset.itemsPerPage) || 8;
      
      const infiniteScroll = new module.default(container, {
        cardType: cardType,
        itemsPerPage: itemsPerPage,
        rootMargin: '100px',
        delay: 600,
      });
      
      // Listen to events
      container.addEventListener('itemsLoaded', (e) => {
        console.log(`${e.detail.cardType}: loaded ${e.detail.items.length} items`);
        
        // Analytics tracking
        if (window.gtag) {
          window.gtag('event', 'infinite_scroll_load', {
            content_type: e.detail.cardType,
            items_loaded: e.detail.items.length,
            page_number: e.detail.page
          });
        }
      });
      
      container.addEventListener('loadError', (e) => {
        console.error(`Error loading ${e.detail.cardType}:`, e.detail.error);
      });
      
      // Retry functionality
      const retryButton = container.querySelector('[data-retry]');
      if (retryButton) {
        retryButton.addEventListener('click', () => {
          infiniteScroll.reload();
        });
      }
    });
  }
);
</script>