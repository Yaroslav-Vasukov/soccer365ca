const Y=["January","February","March","April","May","June","July","August","September","October","November","December"],L=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],v=n=>String(n).padStart(2,"0"),E=(n,s,g)=>`${n}-${v(s+1)}-${v(g)}`,T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(n){const s=String(n.getDate()).padStart(2,"0"),g=T[n.getMonth()],C=String(n.getHours()).padStart(2,"0"),y=String(n.getMinutes()).padStart(2,"0");return`${s} ${g}, ${C}:${y}`}function H(n){const s=n.querySelector('[data-el="grid"]'),g=n.querySelector('[data-el="month"]'),C=n.querySelector('[data-el="year"]'),y=n.querySelector('[data-el="matches"]'),M=n.querySelector('[data-el="matches-date"]');let f={};try{f=JSON.parse(n.dataset.matches||"{}")}catch{f={}}const S=new Date;S.setHours(0,0,0,0);let d=new Date(S.getFullYear(),S.getMonth(),1),m=new Date(S);const q=n.querySelector("[data-prev-month]"),b=n.querySelector("[data-next-month]");q&&q.addEventListener("click",()=>{d=new Date(d.getFullYear(),d.getMonth()-1,1),p()}),b&&b.addEventListener("click",()=>{d=new Date(d.getFullYear(),d.getMonth()+1,1),p()}),p();function p(){F(),N(),_()}function F(){g.textContent=Y[d.getMonth()],C.textContent=d.getFullYear()}function N(){s.innerHTML="";const l=document.createElement("div");l.className="calendar__dow",L.forEach(r=>{const u=document.createElement("span");u.textContent=r,l.appendChild(u)}),s.appendChild(l);const o=d.getFullYear(),c=d.getMonth(),e=new Date(o,c,1),t=new Date(o,c+1,0).getDate(),i=(e.getDay()+6)%7,a=new Date(o,c,0).getDate();for(let r=0;r<i;r++){const u=a-i+1+r;s.appendChild(w(new Date(o,c-1,u),!0))}for(let r=1;r<=t;r++)s.appendChild(w(new Date(o,c,r),!1));const D=(7-(i+t)%7)%7;for(let r=1;r<=D;r++)s.appendChild(w(new Date(o,c+1,r),!0))}function w(l,o){var r;const c=l.getFullYear(),e=l.getMonth(),t=l.getDate(),i=E(c,e,t),a=document.createElement("button");a.type="button",a.className="calendar__cell"+(o?" calendar__cell--muted":""),a.setAttribute("role","gridcell"),a.setAttribute("aria-selected",String(x(l,m))),a.dataset.date=i,x(l,S)&&a.classList.add("calendar__today");const h=document.createElement("div");h.className="calendar__daynum",h.textContent=t,a.appendChild(h);const D=((r=f[i])==null?void 0:r.length)||0;if(D){const u=document.createElement("div");u.className="calendar__badge",u.textContent=D,a.appendChild(u)}return a.addEventListener("click",()=>{m=new Date(c,e,t),o?(d=new Date(c,e,1),p()):(s.querySelectorAll('.calendar__cell[aria-selected="true"]').forEach(u=>u.setAttribute("aria-selected","false")),a.setAttribute("aria-selected","true"),_())}),a}function x(l,o){return l.getFullYear()===o.getFullYear()&&l.getMonth()===o.getMonth()&&l.getDate()===o.getDate()}function _(){const l=E(m.getFullYear(),m.getMonth(),m.getDate());M&&(M.textContent=l);const o=f[l]||[];if(y.innerHTML="",!o.length){y.innerHTML='<p class="muted">No matches scheduled.</p>';return}const c=document.getElementById("tpl-card-match");if(!c){console.warn("[calendar] Missing #tpl-card-match");return}o.forEach(e=>{const t=c.content.cloneNode(!0);t.querySelector('[data-el="home-link"]').href=e.home.href,t.querySelector('[data-el="home-logo"]').src=e.home.logo,t.querySelector('[data-el="home-logo"]').alt=e.home.name,t.querySelector('[data-el="home-name"]').textContent=e.home.name,t.querySelector('[data-el="score-home"]').textContent=e.score_home??"—",t.querySelector('[data-el="away-link"]').href=e.away.href,t.querySelector('[data-el="away-logo"]').src=e.away.logo,t.querySelector('[data-el="away-logo"]').alt=e.away.name,t.querySelector('[data-el="away-name"]').textContent=e.away.name,t.querySelector('[data-el="score-away"]').textContent=e.score_away??"—";const i=e.date_value?new Date(e.date_value):null;t.querySelector('[data-el="date"]').textContent=i?k(i):"",t.querySelector('[data-el="status"]').textContent=e.status||"Scheduled";const a=t.querySelector('[data-el="league-link"]');e.league?(a.href=e.league.href,a.textContent=e.league.name):(a.removeAttribute("href"),a.textContent="");const h=t.querySelector('[data-el="button"]');e.button&&e.button.url&&e.button.label?(h.href=e.button.url,h.textContent=e.button.label,h.hidden=!1):h.hidden=!0,y.appendChild(t)})}}function A(){document.querySelectorAll("[data-calendar]").forEach(H)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",A,{once:!0}):A();export{A as default};
